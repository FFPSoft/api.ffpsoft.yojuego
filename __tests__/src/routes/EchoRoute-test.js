var fetch = require('node-fetch');

describe('MatchRoutes', () => {
  pit('Should recive status code 200', () => {
    return fetch('http://127.0.0.1:8080/echo', {
      method: 'post'
    })
    .then((response) => {
      expect(response.status)
      .toBe(200);
    }, (ret) => expect(true).toBe(false));
  });

  pit('Should recive same body request on response payload', () => {
    var aBody = { name: "name1", id: 1 };
    return fetch('http://127.0.0.1:8080/echo', {
      headers: {'Content-Type': 'application/json'},
      method: 'post',
      body: JSON.stringify(aBody)
    })
    .then((response) => {
      expect(response.status)
      .toBe(200);
      //console.log(response);
      return response.json();
    })
    .then((payload) => {
      expect(payload)
      .toEqual(aBody);
    }, (ret) => expect('reject fail').toBe(''));
  });
});
